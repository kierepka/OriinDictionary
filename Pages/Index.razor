@page "/"
@page "/{SearchText}"
@inherits DicBasePage
<PageHeader IsLoading="@(SearchState?.Value.IsLoading ?? true)" CurrentAlertText="@CurrentAlert" LoadingText="@MyText?.loading" HeaderText="@MyText?.headerShowDashboard" />

<h1>@SearchText</h1>

<!-- Search buttons bar -->
<Addons>
    <Addon AddonType="AddonType.Body">
        <TextEdit Placeholder="@MyText?.search" Text="@SearchText"
                  TextChanged="@(value => GoSearchText(value))" />
    </Addon>

    <Addon AddonType="AddonType.End">
        <Buttons>
            <Keyboard KeyboardVisible="false" OnKeyCallback="@OnKeyboardKey" MyTextLoading="@MyText?.loading" MyLanguage="@_currentLanguage1" />
            <Dropdown>
                <Button>@MyText?.baseTermLanguage: @_currentLanguage1?.Name</Button>
                <DropdownToggle Color="Color.Primary" IsSplit="true" />

                <DropdownMenu>
                    @if (!(LanguagesState is null))
                    {
                        @foreach (var l in OriinDic.Helpers.Const.BaseLanguagesList)
                        {
                            <DropdownItem TValue="int" Value="@l" Clicked="@(_ => ClickedDropdownItem1(l))">@LanguagesState?.Value.GetLanguageName(l)</DropdownItem>
                            <DropdownDivider />
                        }
                    }
                </DropdownMenu>
            </Dropdown>
        </Buttons>
    </Addon>

    <Addon AddonType="AddonType.End">
        <Buttons>
            <Button Clicked="@SwapLanguages">
                <span role="img">
                    <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"></path></svg>
                </span>
            </Button>
        </Buttons>
    </Addon>

    <Addon AddonType="AddonType.End">
        <Buttons>
            <Keyboard KeyboardVisible="false" OnKeyCallback="@OnKeyboardKey" MyTextLoading="@MyText?.loading" MyLanguage="@_currentLanguage2" />
            <Dropdown>
                <Button>@_currentLanguage2?.Name</Button>
                <DropdownToggle Color="Color.Primary" IsSplit="true" />
                <DropdownMenu>
                    @if (!(LanguagesState is null))
                    {
                        @foreach (var l in LanguagesState.Value.TranslationLanguages)
                        {
                            <DropdownItem TValue="int" Value="@l.Id" Clicked="@(_ => ClickedDropdownItem2(l))">@l.Name</DropdownItem>
                            <DropdownDivider />
                        }
                    }

                </DropdownMenu>
            </Dropdown>
        </Buttons>
    </Addon>
    <Addon AddonType="AddonType.End">
        <Button Color="Color.Success"
                Clicked="@ButtonSearchClicked">
            @MyText?.search
        </Button>

    </Addon>
</Addons>

@if (!(SearchState?.Value.SearchItems is null))
{
    <Table IsStriped="true" IsHoverable="true" Theme="Theme.Dark">
        <TableHeader>
            <TableRow>
                <TableHeaderCell>@MyText?.termTitle</TableHeaderCell>
                <TableHeaderCell>@MyText?.translationTitle</TableHeaderCell>                
            </TableRow>
        </TableHeader>
        <TableBody>
            @foreach (var locDic in SearchState.Value.SearchItems)
            {
                <TableRow>
                    <TableRowCell>


                        @if (locDic.BaseName is null)
                        {
                            <div class="box @SearchState.Value.ButtonPlColor">
                                <a href="/addbaseterm">@MyText?.addBase</a>
                            </div>
                        }
                        else
                        {
                            <div class="box @SearchState.Value.ButtonPlColor">
                                <a href="/editbaseterm/@locDic.BaseTermSlug">
                                    "@locDic.BaseName"
                                </a>
                            </div>
                        }

                    </TableRowCell>
                    
                    <TableRowCell>

                        @if (locDic.TranslateName is null)
                        {
                            <div class="box @SearchState.Value.ButtonEnColor">
                                <a href="/addtranslation/@locDic.BaseTermId">@MyText?.addTranslation</a>
                            </div>
                        }
                        else
                        {
                            <div class="box @SearchState.Value.ButtonEnColor">
                                <a href="/edittranslation/@locDic.TranslateId">"@locDic.TranslateName"</a>
                            </div>
                        }

                    </TableRowCell>
                    
                </TableRow>
            }
        </TableBody>
    </Table>

}

@if (SearchState?.Value.PaginationShow ?? false)
{
    <MyPagination LocalPages="@SearchState.Value.LocalPages"
                  SearchPageNr="@_searchPageNr"
                  TotalPages="@SearchState.Value.TotalPages"
                  PrevText="@MyText?.next"
                  NextText="@MyText?.previous"
                  OnClickCallback="OnPageClick">
    </MyPagination>
}


<!-- Information for search -->
<Addons>
    <Addon AddonType="AddonType.End">
        <AddonLabel>@MyText?.loadedNrRows</AddonLabel>
    </Addon>
    <Addon AddonType="AddonType.End">
        <AddonLabel>@(SearchState?.Value.TotalSearchItems ?? 0)</AddonLabel>
    </Addon>
    <Addon AddonType="AddonType.End">
    </Addon>
</Addons>
<SurveyPrompt Title="@MyText?.somethingWrong" />